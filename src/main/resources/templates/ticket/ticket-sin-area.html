<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tickets sin Área Asignada</title>
    <link rel="stylesheet" href="/css/style.css"> </head>
	<style>
	        /* General Body Styles */
	        body {
	            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
	            line-height: 1.6;
	            color: #333;
	            background-color: #f0f2f5; /* Soft background */
	            margin: 0;
	            padding: 0;
	            display: flex;
	            flex-direction: column;
	            min-height: 100vh;
	        }

	        /* Header Styles */
	        header {
	            background-color: #2c3e50; /* Dark blue-gray */
	            color: #ffffff;
	            padding: 15px 30px;
	            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
	            display: flex;
	            justify-content: space-between;
	            align-items: center;
	        }

	        header h1 {
	            margin: 0;
	            font-size: 1.8em;
	            color: #ecf0f1; /* Lighter color for header text */
	        }

	        header nav ul {
	            list-style: none;
	            margin: 0;
	            padding: 0;
	            display: flex;
	        }

	        header nav ul li {
	            margin-left: 25px;
	        }

	        header nav ul li a {
	            color: #ffffff;
	            text-decoration: none;
	            font-weight: bold;
	            padding: 5px 0;
	            transition: color 0.3s ease;
	        }

	        header nav ul li a:hover {
	            color: #3498db; /* Blue accent on hover */
	        }

	        /* Main Content Area */
	        main {
	            flex: 1; /* Allows main content to grow and fill available space */
	            max-width: 1200px;
	            margin: 30px auto;
	            background: #fff;
	            padding: 30px;
	            border-radius: 8px;
	            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
	        }

	        /* Alert Messages */
	        .alert {
	            padding: 15px;
	            margin-bottom: 20px;
	            border-radius: 5px;
	            font-size: 1em;
	            border: 1px solid transparent;
	        }

	        .alert-danger {
	            background-color: #f8d7da;
	            color: #721c24;
	            border-color: #f5c6cb;
	        }

	        .alert-success {
	            background-color: #d4edda;
	            color: #155724;
	            border-color: #c3e6cb;
	        }

	        .alert-info {
	            background-color: #d1ecf1;
	            color: #0c5460;
	            border-color: #bee5eb;
	        }

	        /* Table Styling */
	        table {
	            width: 100%;
	            border-collapse: collapse;
	            margin-top: 25px;
	            box-shadow: 0 1px 5px rgba(0,0,0,0.08);
	            border-radius: 8px;
	            overflow: hidden; /* Ensures rounded corners are applied */
	        }

	        th, td {
	            padding: 14px 18px;
	            text-align: left;
	            border-bottom: 1px solid #e0e0e0;
	        }

	        th {
	            background-color: #3498db; /* Blue header */
	            color: white;
	            font-weight: 600;
	            text-transform: uppercase;
	            font-size: 0.9em;
	        }

	        tbody tr:nth-child(even) { /* Zebra striping */
	            background-color: #f9f9f9;
	        }

	        tbody tr:hover {
	            background-color: #e9f7fe; /* Light blue on hover */
	        }

	        /* Form within Table Cell */
	        table td form {
	            display: flex;
	            align-items: center;
	            gap: 10px; /* Space between select and button */
	            margin: 0; /* Remove default form margin */
	        }

	        table td select {
	            padding: 8px 12px;
	            border: 1px solid #ccc;
	            border-radius: 4px;
	            font-size: 0.9em;
	            background-color: #fff;
	            appearance: none; /* Remove default system arrow */
	            -webkit-appearance: none;
	            -moz-appearance: none;
	            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23007bff%22%20d%3D%22M287%2069.2c-3.6-3.6-7.9-5.4-12.8-5.4H18.3c-4.9%200-9.2%201.8-12.8%205.4-3.6%203.6-5.4%207.9-5.4%2012.8s1.8%209.2%205.4%2012.8L130.3%20228.6c3.6%203.6%207.9%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4l119.9-119.9c3.6-3.6%205.4-7.9%205.4-12.8s-1.8-9.2-5.4-12.8z%22%2F%3E%3C%2Fsvg%3E'); /* Custom arrow */
	            background-repeat: no-repeat;
	            background-position: right 8px top 50%;
	            background-size: 12px auto;
	            cursor: pointer;
	        }

	        table td select:focus {
	            border-color: #3498db;
	            outline: none;
	            box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
	        }

	        table td button {
	            padding: 8px 15px;
	            background-color: #28a745; /* Green assign button */
	            color: white;
	            border: none;
	            border-radius: 4px;
	            cursor: pointer;
	            font-weight: bold;
	            transition: background-color 0.2s ease;
	        }

	        table td button:hover {
	            background-color: #218838;
	        }

	        /* Back to List Link */
	        main > p > a {
	            display: inline-block;
	            margin-top: 30px;
	            padding: 10px 15px;
	            background-color: #6c757d; /* Gray for navigation */
	            color: white;
	            text-decoration: none;
	            border-radius: 5px;
	            transition: background-color 0.3s ease;
	        }

	        main > p > a:hover {
	            background-color: #5a6268;
	        }
	    </style>
<body>
    <header>
        <h1>Tickets sin Área Asignada</h1>
        <nav>
            <ul>
                <li><a th:href="@{/panel}">Panel de Control</a></li>
                <li><a th:href="@{/ticket/lista}">Todos los Tickets</a></li>
                <li><a th:href="@{/logout}">Cerrar Sesión</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <div th:if="${successMessage}" class="alert alert-success">
            <p th:text="${successMessage}"></p>
        </div>
        <div th:if="${errorMessage}" class="alert alert-danger">
            <p th:text="${errorMessage}"></p>
        </div>

        <div th:if="${#lists.isEmpty(tickets)}" class="alert alert-info">
            <p>No hay tickets sin área asignada en este momento.</p>
        </div>

        <div th:unless="${#lists.isEmpty(tickets)}">
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Título</th>
                        <th>Descripción</th>
                        <th>Estado</th>
                        <th>Prioridad</th>
                        <th>Fecha Creación</th>
						<th>Area Asignada</th>
                        <th>Asignar Área</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="ticket : ${tickets}">
                        <td th:text="${ticket.idTicket}"></td>
                        <td th:text="${ticket.titulo}"></td>
                        <td th:text="${ticket.descripcion}"></td>
                        <td th:text="${ticket.estado != null ? ticket.estado.name() : 'N/A'}"></td>
                        <td th:text="${ticket.prioridad != null ? ticket.prioridad.name() : 'N/A'}"></td>
                        <td th:text="${ticket.fechaCreacion}"></td>
						<td th:text="${ticket.area != null ? ticket.area.name() : 'N/A'}"></td>
                        <td>
                            <form th:action="@{/ticket/{idTicket}/asignarArea(idTicket=${ticket.idTicket})}" method="post">
                                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                                <select name="area" required>
                                    <option value="">Seleccione un área</option>
                                    <option th:each="area : ${areas}" th:value="${area}" th:text="${area.name()}"></option>
                                </select>
                                <button type="submit">Asignar</button>
                            </form>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p><a th:href="@{/ticket/lista}">Volver a la lista de todos los tickets</a></p>
    </main>
</body>
</html>